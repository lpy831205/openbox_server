import{_ as ze,u as qe,r,y as Ee,o as Me,c as p,P as Ne,d as he,e as G,g as t,w as l,k as V,a3 as pe,n as i,t as u,f as o,Z as Ge,a1 as ce,S as Qe,Q as le,p as ae,a0 as Ze,M as v,E as c,$ as me,a2 as se}from"./index-IjbujgFK.js";import"./crypto-wasm-7Ru5Q_sa.js";const je={class:"superadmin-container"},He={class:"card-header"},Je={class:"device-code"},Ke={class:"action-buttons"},We={class:"card-header"},Xe={class:"security-stats"},Ye={class:"stat-item"},et={class:"stat-value"},tt={class:"stat-item"},lt={class:"stat-value"},at={class:"stat-item"},st={class:"stat-value"},ot={class:"stat-item stat-last-updated"},it={class:"stat-time"},nt={class:"security-actions"},rt={class:"card-header"},ut={class:"action-buttons"},dt={class:"action-buttons"},pt={class:"card-header"},ct={class:"confirm-user-info"},mt={class:"dialog-footer"},ft={class:"dialog-footer"},vt={class:"dialog-footer"},gt={class:"dialog-footer"},bt={class:"activity-details"},yt={class:"dialog-footer"},_t={__name:"SuperAdmin",setup(wt){const fe=qe(),oe=r("activate"),f=r(!1),ie=r([]),ne=r([]),Q=r([]),Z=r([]),O=r([]),C=r({totalFailedLogins:0,totalSuspiciousActivities:0,blockedIpCount:0,lastUpdated:""}),I=r(!1),z=r("all"),ve=Ee(()=>z.value==="all"?O.value:O.value.filter(s=>s.level===z.value)),T=r(!1),x=r(!1),P=r(!1),q=r(!1),$=r(!1),F=r(null),j=r(null),A=r(null),ge=r(null),S=r(null),b=r({account:"",currentRole:"",confirm:!1}),be={confirm:[{type:"boolean",message:"请确认操作",trigger:"change",transform:s=>s===!0}]},_=r({ip:"",reason:""}),ye={ip:[{required:!0,message:"请输入IP地址",trigger:"blur"},{pattern:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,message:"请输入有效的IP地址",trigger:"blur"}],reason:[{required:!0,message:"请输入封禁原因",trigger:"blur"}]},m=r({account:"",role:"",confirm:!1}),_e={account:[{required:!0,message:"请输入账号",trigger:"blur"}],role:[{required:!0,message:"请输入角色名称",trigger:"blur"}],confirm:[{type:"boolean",message:"请确认操作",trigger:"change",transform:s=>s===!0}]},w=r({deviceCode:""}),H=async()=>{try{const s=await v.get("/api/admin/users/query");ie.value=s.data||[]}catch(s){c.error("获取用户列表失败："+s.message)}},J=async()=>{try{const e=(await v.get("/api/superadmin/blacklist-ips")).data.blacklist_ips||[];ne.value=e.map(g=>({ip:g,addTime:new Date().toISOString(),reason:"系统添加"}))}catch(s){c.error("获取IP黑名单失败："+s.message)}},K=async()=>{try{I.value=!0;const s=await v.get("/api/superadmin/security/failed-logins");Q.value=s.data||[];const e=await v.get("/api/superadmin/security/suspicious-activities");Z.value=e.data||[];const g=await v.get("/api/superadmin/security/system-logs",{params:{limit:100}});O.value=g.data||[];const W=await v.get("/api/superadmin/security/stats");C.value=W.data||{totalFailedLogins:0,totalSuspiciousActivities:0,blockedIpCount:0,lastUpdated:new Date().toISOString()},c.success("安全监控数据已更新")}catch(s){c.error("获取安全监控数据失败："+s.message),Q.value=[{ip:"192.168.1.100",attempts:5,lastAttempt:new Date().toISOString(),account:"user1",reason:"多次登录失败"},{ip:"10.0.0.50",attempts:3,lastAttempt:new Date().toISOString(),account:"admin2",reason:"多次登录失败"},{ip:"172.16.0.10",attempts:8,lastAttempt:new Date().toISOString(),account:"test",reason:"多次登录失败"}],Z.value=[{ip:"192.168.1.200",type:"异常请求",timestamp:new Date().toISOString(),details:"频繁访问敏感接口",severity:"high"},{ip:"10.0.0.25",type:"暴力破解",timestamp:new Date().toISOString(),details:"尝试破解管理员账号",severity:"critical"},{ip:"172.16.0.5",type:"异常登录",timestamp:new Date().toISOString(),details:"非常规时间登录系统",severity:"medium"}],O.value=[{timestamp:new Date().toISOString(),level:"warning",message:"用户admin多次尝试访问未授权资源",source:"auth-service"},{timestamp:new Date(Date.now()-36e5).toISOString(),level:"error",message:"数据库连接异常",source:"db-service"},{timestamp:new Date(Date.now()-72e5).toISOString(),level:"info",message:"系统定时备份完成",source:"backup-service"}],C.value={totalFailedLogins:56,totalSuspiciousActivities:12,blockedIpCount:5,lastUpdated:new Date().toISOString()}}finally{I.value=!1}},re=async s=>{try{await se.confirm(`确定要清除${s?`IP ${s} 的`:"所有"}失败登录记录吗？`,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await v.post("/api/superadmin/security/clear-failed-logins",{ip:s||null}),c.success(`${s?`IP ${s} 的`:"所有"}失败登录记录已清除`),await K()}catch(e){e!=="cancel"&&c.error("清除失败登录记录失败："+e.message)}},we=s=>{switch(s){case"critical":return"danger";case"high":return"warning";case"medium":return"info";case"low":return"success";default:return"info"}},ke=s=>{switch(s){case"error":return"danger";case"warning":return"warning";case"info":return"info";case"debug":return"success";default:return"info"}},Ve=s=>{b.value.account=s.account,b.value.currentRole=ue(s.role),b.value.confirm=!1,T.value=!0,me(()=>{F.value&&F.value.resetFields()})},Ce=s=>{m.value.account=s.account,m.value.role="",m.value.confirm=!1,P.value=!0,me(()=>{A.value&&A.value.resetFields()})},Ie=async()=>{if(F.value)try{await F.value.validate(),f.value=!0,await v.post("/api/superadmin/activate-admin",{account:b.value.account}),c.success("管理员激活成功"),T.value=!1,await H()}catch(s){s.message&&c.error("激活管理员失败："+s.message)}finally{f.value=!1}},Se=()=>{_.value={ip:"",reason:""},x.value=!0},De=async()=>{if(j.value)try{await j.value.validate(),f.value=!0,await v.post("/api/superadmin/blacklist-ip",{ip:_.value.ip,action:"add"}),c.success("IP已添加到黑名单"),x.value=!1,await J()}catch(s){s.message&&c.error("添加IP到黑名单失败："+s.message)}finally{f.value=!1}},Re=async s=>{try{await se.confirm(`确定要从黑名单中移除IP ${s} 吗？`,"确认操作",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await v.post("/api/superadmin/blacklist-ip",{ip:s,action:"remove"}),c.success("IP已从黑名单移除"),await J()}catch(e){e!=="cancel"&&c.error("移除IP失败："+e.message)}},Te=()=>{K()},xe=()=>{fe.back()},Pe=s=>{switch(s){case"superadmin":return"danger";case"admin":return"warning";default:return"success"}},ue=s=>{switch(s){case"superadmin":return"超级管理员";case"admin":return"管理员";default:return"普通用户"}},$e=s=>s?`${s.slice(0,8)}...${s.slice(-8)}`:"",y=s=>s?new Date(s).toLocaleString():"",Fe=()=>{w.value?w.value.deviceCode="":w.value={deviceCode:""},$.value=!0},Ae=async()=>{try{f.value=!0;const s=await v.post("/api/admin/generate-invite",{device_code:w.value.deviceCode});c.success("邀请码生成成功"),se.alert(s.data.invite_code,"邀请码",{confirmButtonText:"复制",callback:e=>{e==="confirm"&&(navigator.clipboard.writeText(s.data.invite_code),c.success("已复制到剪贴板"))}}),$.value=!1}catch(s){c.error("生成邀请码失败："+s.message)}finally{f.value=!1}},Ue=async()=>{if(A.value)try{await A.value.validate(),f.value=!0,await v.post("/api/superadmin/set-custom-role",{account:m.value.account,role:m.value.role}),c.success("角色设置成功"),P.value=!1,await H()}catch(s){s.message&&c.error("设置角色失败："+s.message)}finally{f.value=!1}},Be=s=>{S.value=s,q.value=!0};return Me(async()=>{await H(),await J(),await K()}),(s,e)=>{const g=p("el-icon"),W=p("el-page-header"),d=p("el-button"),X=p("el-alert"),n=p("el-table-column"),E=p("el-tag"),U=p("el-table"),D=p("el-card"),Y=p("el-tab-pane"),M=p("el-col"),ee=p("el-row"),N=p("el-radio-button"),Le=p("el-radio-group"),Oe=p("el-tabs"),de=p("el-checkbox"),k=p("el-form-item"),h=p("el-form"),B=p("el-dialog"),L=p("el-input"),te=Ne("loading");return G(),he("div",je,[t(W,{onBack:xe,content:"超级管理员面板"},{icon:l(()=>[t(g,null,{default:l(()=>[t(V(pe))]),_:1})]),_:1}),t(Oe,{modelValue:oe.value,"onUpdate:modelValue":e[2]||(e[2]=a=>oe.value=a),class:"superadmin-tabs"},{default:l(()=>[t(Y,{label:"激活管理员",name:"activate"},{default:l(()=>[t(D,null,{header:l(()=>[o("div",He,[e[21]||(e[21]=o("span",null,"用户管理",-1)),t(d,{type:"primary",onClick:Fe},{default:l(()=>[t(g,null,{default:l(()=>[t(V(ce))]),_:1}),e[20]||(e[20]=i(" 生成邀请码 "))]),_:1})])]),default:l(()=>[t(X,{title:"注意：激活管理员权限是不可逆操作，请谨慎操作！",type:"warning",closable:!1,"show-icon":"",class:"mb-4"}),t(U,{data:ie.value,border:"",stripe:"",style:{width:"100%"}},{default:l(()=>[t(n,{prop:"account",label:"账号",width:"150"}),t(n,{prop:"role",label:"角色",width:"120"},{default:l(({row:a})=>[t(E,{type:Pe(a.role)},{default:l(()=>[i(u(ue(a.role)),1)]),_:2},1032,["type"])]),_:1}),t(n,{prop:"deviceCode",label:"设备码","show-overflow-tooltip":""},{default:l(({row:a})=>[o("span",Je,u($e(a.deviceCode)),1)]),_:1}),t(n,{prop:"registerTime",label:"注册时间",width:"180"},{default:l(({row:a})=>[i(u(y(a.registerTime)),1)]),_:1}),t(n,{prop:"lastLoginTime",label:"最后登录",width:"180"},{default:l(({row:a})=>[i(u(y(a.lastLoginTime)),1)]),_:1}),t(n,{label:"操作",width:"220",fixed:"right"},{default:l(({row:a})=>[o("div",Ke,[t(d,{size:"small",type:"primary",onClick:R=>Ve(a),disabled:a.role==="admin"||a.role==="superadmin",class:"action-btn"},{default:l(()=>[t(g,null,{default:l(()=>[t(V(pe))]),_:1}),e[22]||(e[22]=i(" 激活管理员 "))]),_:2},1032,["onClick","disabled"]),t(d,{size:"small",type:"success",onClick:R=>Ce(a),class:"action-btn"},{default:l(()=>[t(g,null,{default:l(()=>[t(V(Ge))]),_:1}),e[23]||(e[23]=i(" 自定义角色 "))]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),t(Y,{label:"IP黑名单",name:"blacklist"},{default:l(()=>[t(D,null,{header:l(()=>[o("div",We,[e[25]||(e[25]=o("span",null,"IP黑名单管理",-1)),t(d,{type:"primary",onClick:Se},{default:l(()=>[t(g,null,{default:l(()=>[t(V(ce))]),_:1}),e[24]||(e[24]=i(" 添加IP "))]),_:1})])]),default:l(()=>[t(X,{title:"黑名单中的IP地址将无法访问系统",type:"info",closable:!1,"show-icon":"",class:"mb-4"}),t(U,{data:ne.value,border:"",stripe:"",style:{width:"100%"}},{default:l(()=>[t(n,{prop:"ip",label:"IP地址",width:"200"}),t(n,{prop:"addTime",label:"添加时间",width:"180"},{default:l(({row:a})=>[i(u(y(a.addTime)),1)]),_:1}),t(n,{prop:"reason",label:"封禁原因","show-overflow-tooltip":""}),t(n,{label:"操作",width:"120",fixed:"right"},{default:l(({row:a})=>[t(d,{link:"",type:"danger",onClick:R=>Re(a.ip)},{default:l(()=>e[26]||(e[26]=[i(" 移除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1}),t(Y,{label:"安全监控",name:"security"},{default:l(()=>[t(ee,{gutter:20,class:"mb-4"},{default:l(()=>[t(M,{span:24},{default:l(()=>[t(D,{shadow:"hover",class:"security-stats-card"},{default:l(()=>[o("div",Xe,[o("div",Ye,[o("div",et,u(C.value.totalFailedLogins),1),e[27]||(e[27]=o("div",{class:"stat-label"},"失败登录总数",-1))]),o("div",tt,[o("div",lt,u(C.value.totalSuspiciousActivities),1),e[28]||(e[28]=o("div",{class:"stat-label"},"可疑活动总数",-1))]),o("div",at,[o("div",st,u(C.value.blockedIpCount),1),e[29]||(e[29]=o("div",{class:"stat-label"},"已封禁IP数",-1))]),o("div",ot,[e[30]||(e[30]=o("div",{class:"stat-label"},"最后更新时间",-1)),o("div",it,u(y(C.value.lastUpdated)),1)])]),o("div",nt,[t(d,{type:"primary",onClick:Te,loading:I.value},{default:l(()=>[t(g,null,{default:l(()=>[t(V(Qe))]),_:1}),e[31]||(e[31]=i(" 刷新数据 "))]),_:1},8,["loading"])])]),_:1})]),_:1})]),_:1}),t(ee,{gutter:20},{default:l(()=>[t(M,{span:12},{default:l(()=>[t(D,{class:"security-card",shadow:"hover"},{header:l(()=>[o("div",rt,[e[33]||(e[33]=o("span",null,"登录失败统计",-1)),o("div",null,[t(d,{size:"small",onClick:e[0]||(e[0]=a=>re())},{default:l(()=>[t(g,null,{default:l(()=>[t(V(Ze))]),_:1}),e[32]||(e[32]=i(" 清除全部 "))]),_:1})])])]),default:l(()=>[le((G(),ae(U,{data:Q.value,border:"",stripe:"",style:{width:"100%"}},{default:l(()=>[t(n,{prop:"ip",label:"IP地址",width:"130"}),t(n,{prop:"account",label:"账号",width:"100"}),t(n,{prop:"attempts",label:"失败次数",width:"80",sortable:""},{default:l(({row:a})=>[t(E,{type:a.attempts>5?"danger":"warning",effect:"dark"},{default:l(()=>[i(u(a.attempts),1)]),_:2},1032,["type"])]),_:1}),t(n,{prop:"reason",label:"失败原因",width:"120"}),t(n,{prop:"lastAttempt",label:"最后尝试",width:"160"},{default:l(({row:a})=>[i(u(y(a.lastAttempt)),1)]),_:1}),t(n,{label:"操作",width:"160",fixed:"right"},{default:l(({row:a})=>[o("div",ut,[t(d,{link:"",type:"primary",size:"small",onClick:R=>re(a.ip)},{default:l(()=>e[34]||(e[34]=[i(" 清除记录 ")])),_:2},1032,["onClick"]),t(d,{link:"",type:"danger",size:"small",onClick:R=>s.addToBlacklist(a.ip,"多次登录失败")},{default:l(()=>e[35]||(e[35]=[i(" 加入黑名单 ")])),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[te,I.value]])]),_:1})]),_:1}),t(M,{span:12},{default:l(()=>[t(D,{class:"security-card",shadow:"hover"},{header:l(()=>e[36]||(e[36]=[o("div",{class:"card-header"},[o("span",null,"可疑活动")],-1)])),default:l(()=>[le((G(),ae(U,{data:Z.value,border:"",stripe:"",style:{width:"100%"}},{default:l(()=>[t(n,{prop:"ip",label:"IP地址",width:"130"}),t(n,{prop:"type",label:"活动类型",width:"100"}),t(n,{prop:"severity",label:"严重性",width:"80"},{default:l(({row:a})=>[t(E,{type:we(a.severity),effect:"dark"},{default:l(()=>[i(u(a.severity||"中"),1)]),_:2},1032,["type"])]),_:1}),t(n,{prop:"timestamp",label:"时间",width:"160"},{default:l(({row:a})=>[i(u(y(a.timestamp)),1)]),_:1}),t(n,{prop:"details",label:"详情","show-overflow-tooltip":""}),t(n,{label:"操作",width:"160",fixed:"right"},{default:l(({row:a})=>[o("div",dt,[t(d,{link:"",type:"primary",size:"small",onClick:R=>Be(a)},{default:l(()=>e[37]||(e[37]=[i(" 查看详情 ")])),_:2},1032,["onClick"]),t(d,{link:"",type:"danger",size:"small",onClick:R=>s.addToBlacklist(a.ip,a.details)},{default:l(()=>e[38]||(e[38]=[i(" 加入黑名单 ")])),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[te,I.value]])]),_:1})]),_:1})]),_:1}),t(ee,{gutter:20,class:"mt-4"},{default:l(()=>[t(M,{span:24},{default:l(()=>[t(D,{class:"security-card",shadow:"hover"},{header:l(()=>[o("div",pt,[e[43]||(e[43]=o("span",null,"系统日志",-1)),t(Le,{modelValue:z.value,"onUpdate:modelValue":e[1]||(e[1]=a=>z.value=a),size:"small"},{default:l(()=>[t(N,{label:"all"},{default:l(()=>e[39]||(e[39]=[i("全部")])),_:1}),t(N,{label:"error"},{default:l(()=>e[40]||(e[40]=[i("错误")])),_:1}),t(N,{label:"warning"},{default:l(()=>e[41]||(e[41]=[i("警告")])),_:1}),t(N,{label:"info"},{default:l(()=>e[42]||(e[42]=[i("信息")])),_:1})]),_:1},8,["modelValue"])])]),default:l(()=>[le((G(),ae(U,{data:ve.value,border:"",stripe:"",style:{width:"100%"},height:"300"},{default:l(()=>[t(n,{prop:"timestamp",label:"时间",width:"160"},{default:l(({row:a})=>[i(u(y(a.timestamp)),1)]),_:1}),t(n,{prop:"level",label:"级别",width:"100"},{default:l(({row:a})=>[t(E,{type:ke(a.level),effect:"plain"},{default:l(()=>[i(u(a.level),1)]),_:2},1032,["type"])]),_:1}),t(n,{prop:"source",label:"来源",width:"120"}),t(n,{prop:"message",label:"消息","show-overflow-tooltip":""})]),_:1},8,["data"])),[[te,I.value]])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(B,{modelValue:T.value,"onUpdate:modelValue":e[5]||(e[5]=a=>T.value=a),title:"激活管理员",width:"500px","destroy-on-close":""},{footer:l(()=>[o("span",mt,[t(d,{onClick:e[4]||(e[4]=a=>T.value=!1)},{default:l(()=>e[47]||(e[47]=[i("取消")])),_:1}),t(d,{type:"primary",onClick:Ie,loading:f.value,disabled:!b.value.confirm},{default:l(()=>e[48]||(e[48]=[i(" 确认激活 ")])),_:1},8,["loading","disabled"])])]),default:l(()=>[t(X,{title:"激活管理员权限后将无法撤销，请确认操作",type:"warning",closable:!1,"show-icon":"",class:"mb-4"}),o("div",ct,[o("p",null,[e[44]||(e[44]=o("strong",null,"账号：",-1)),i(u(b.value.account),1)]),o("p",null,[e[45]||(e[45]=o("strong",null,"当前角色：",-1)),i(u(b.value.currentRole),1)])]),t(h,{ref_key:"activateFormRef",ref:F,model:b.value,rules:be,"label-position":"top"},{default:l(()=>[t(k,{label:"确认操作",prop:"confirm"},{default:l(()=>[t(de,{modelValue:b.value.confirm,"onUpdate:modelValue":e[3]||(e[3]=a=>b.value.confirm=a)},{default:l(()=>e[46]||(e[46]=[i(" 我确认要将此账号激活为管理员（此操作不可逆） ")])),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(B,{modelValue:x.value,"onUpdate:modelValue":e[9]||(e[9]=a=>x.value=a),title:"添加IP到黑名单",width:"500px","destroy-on-close":""},{footer:l(()=>[o("span",ft,[t(d,{onClick:e[8]||(e[8]=a=>x.value=!1)},{default:l(()=>e[49]||(e[49]=[i("取消")])),_:1}),t(d,{type:"primary",onClick:De,loading:f.value},{default:l(()=>e[50]||(e[50]=[i(" 添加 ")])),_:1},8,["loading"])])]),default:l(()=>[t(h,{ref_key:"blacklistFormRef",ref:j,model:_.value,rules:ye,"label-position":"top"},{default:l(()=>[t(k,{label:"IP地址",prop:"ip"},{default:l(()=>[t(L,{modelValue:_.value.ip,"onUpdate:modelValue":e[6]||(e[6]=a=>_.value.ip=a),placeholder:"请输入IP地址，如：192.168.1.100",clearable:""},null,8,["modelValue"])]),_:1}),t(k,{label:"封禁原因",prop:"reason"},{default:l(()=>[t(L,{modelValue:_.value.reason,"onUpdate:modelValue":e[7]||(e[7]=a=>_.value.reason=a),type:"textarea",rows:3,placeholder:"请输入封禁原因",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(B,{modelValue:P.value,"onUpdate:modelValue":e[14]||(e[14]=a=>P.value=a),title:"设置自定义角色",width:"500px","destroy-on-close":""},{footer:l(()=>[o("span",vt,[t(d,{onClick:e[13]||(e[13]=a=>P.value=!1)},{default:l(()=>e[52]||(e[52]=[i("取消")])),_:1}),t(d,{type:"primary",onClick:Ue,loading:f.value,disabled:!m.value.confirm},{default:l(()=>e[53]||(e[53]=[i(" 确认设置 ")])),_:1},8,["loading","disabled"])])]),default:l(()=>[t(h,{ref_key:"customRoleFormRef",ref:A,model:m.value,rules:_e,"label-position":"top"},{default:l(()=>[t(k,{label:"目标账号",prop:"account"},{default:l(()=>[t(L,{modelValue:m.value.account,"onUpdate:modelValue":e[10]||(e[10]=a=>m.value.account=a),placeholder:"请输入要设置角色的账号",clearable:""},null,8,["modelValue"])]),_:1}),t(k,{label:"自定义角色",prop:"role"},{default:l(()=>[t(L,{modelValue:m.value.role,"onUpdate:modelValue":e[11]||(e[11]=a=>m.value.role=a),placeholder:"请输入自定义角色名称",clearable:""},null,8,["modelValue"])]),_:1}),t(k,{label:"确认操作",prop:"confirm"},{default:l(()=>[t(de,{modelValue:m.value.confirm,"onUpdate:modelValue":e[12]||(e[12]=a=>m.value.confirm=a)},{default:l(()=>e[51]||(e[51]=[i(" 我确认要将此账号设置为自定义角色 ")])),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(B,{modelValue:$.value,"onUpdate:modelValue":e[17]||(e[17]=a=>$.value=a),title:"生成邀请码",width:"500px","destroy-on-close":""},{footer:l(()=>[o("span",gt,[t(d,{onClick:e[16]||(e[16]=a=>$.value=!1)},{default:l(()=>e[55]||(e[55]=[i("取消")])),_:1}),t(d,{type:"primary",onClick:Ae,loading:f.value},{default:l(()=>e[56]||(e[56]=[i(" 生成 ")])),_:1},8,["loading"])])]),default:l(()=>[t(h,{ref_key:"inviteFormRef",ref:ge,model:w.value,"label-position":"top"},{default:l(()=>[t(k,{label:"设备码（可选）",prop:"deviceCode"},{default:l(()=>[t(L,{modelValue:w.value.deviceCode,"onUpdate:modelValue":e[15]||(e[15]=a=>w.value.deviceCode=a),placeholder:"请输入设备码（可选）",clearable:""},null,8,["modelValue"]),e[54]||(e[54]=o("div",{class:"form-tip"}," 如果不填写设备码，系统将生成通用邀请码 ",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),t(B,{modelValue:q.value,"onUpdate:modelValue":e[19]||(e[19]=a=>q.value=a),title:"可疑活动详情",width:"500px","destroy-on-close":""},{footer:l(()=>[o("span",yt,[t(d,{onClick:e[18]||(e[18]=a=>q.value=!1)},{default:l(()=>e[62]||(e[62]=[i("关闭")])),_:1})])]),default:l(()=>[o("div",bt,[o("p",null,[e[57]||(e[57]=o("strong",null,"IP地址：",-1)),i(u(S.value.ip),1)]),o("p",null,[e[58]||(e[58]=o("strong",null,"活动类型：",-1)),i(u(S.value.type),1)]),o("p",null,[e[59]||(e[59]=o("strong",null,"严重性：",-1)),i(u(S.value.severity),1)]),o("p",null,[e[60]||(e[60]=o("strong",null,"时间：",-1)),i(u(y(S.value.timestamp)),1)]),o("p",null,[e[61]||(e[61]=o("strong",null,"详情：",-1)),i(u(S.value.details),1)])])]),_:1},8,["modelValue"])])}}},Ct=ze(_t,[["__scopeId","data-v-211eb49b"]]);export{Ct as default};
